{"ast":null,"code":"import _toConsumableArray from\"/Users/alinasvyrydova/Downloads/Development/Course1/Files/marvel-hooks/marvel-hooks/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/alinasvyrydova/Downloads/Development/Course1/Files/marvel-hooks/marvel-hooks/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useRef,useEffect}from'react';import useMarvelService from'../../services/MarvelService';import Spinner from'../spinner/Spinner';import ErrorMessage from'../errorMessage/ErrorMessage';import'./charList.scss';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CharList=function CharList(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),chars=_useState2[0],setCharlist=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),newItemLoading=_useState4[0],setNewItemLoading=_useState4[1];var _useState5=useState(210),_useState6=_slicedToArray(_useState5,2),offset=_useState6[0],setOffset=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),charEnded=_useState8[0],setCharEnded=_useState8[1];// focusRef = React.createRef();\nvar _useMarvelService=useMarvelService(),loading=_useMarvelService.loading,error=_useMarvelService.error,getAllCharacters=_useMarvelService.getAllCharacters;// const marvelService = useMarvelService();\nuseEffect(function(){onRequest(offset,true);},[]);var onRequest=function onRequest(offset,initial){initial?setNewItemLoading(false):setNewItemLoading(true);getAllCharacters(offset).then(createList);};var createList=function createList(newCharList){var ended=false;if(newCharList.length<9){ended=true;}setCharlist(function(chars){return[].concat(_toConsumableArray(chars),_toConsumableArray(newCharList));});setNewItemLoading(function(newItemLoading){return false;});setOffset(function(offset){return offset+9;});setCharEnded(function(charEnded){return ended;});};var itemRefs=useRef([]);var focusOnItem=function focusOnItem(id){itemRefs.current.forEach(function(item){return item.classList.remove('char__item_selected');});itemRefs.current[id].classList.add('char__item_selected');itemRefs.current[id].focus();};var elements=chars.map(function(item,i){var name=item.name,thumbnail=item.thumbnail,id=item.id;return/*#__PURE__*/_jsxs(\"li\",{className:\"char__item\",ref:function ref(el){return itemRefs.current[i]=el;},tabIndex:0,onClick:function onClick(){props.onCharSelected(id);focusOnItem(i);},onKeyPress:function onKeyPress(e){if(e.key===' '||e.key===\"Enter\"){props.onCharSelected(id);focusOnItem(i);}},children:[/*#__PURE__*/_jsx(\"img\",{src:thumbnail,alt:name}),/*#__PURE__*/_jsx(\"div\",{className:\"char__name\",children:name})]},id);});var errorMessage=error?/*#__PURE__*/_jsx(ErrorMessage,{}):null;var spinner=loading&&!newItemLoading?/*#__PURE__*/_jsx(Spinner,{}):null;return/*#__PURE__*/_jsxs(\"div\",{className:\"char__list\",children:[/*#__PURE__*/_jsxs(\"ul\",{className:\"char__grid\",children:[errorMessage,spinner,elements]}),/*#__PURE__*/_jsx(\"button\",{className:\"button button__main button__long\",disabled:newItemLoading,style:{'display':charEnded?'none':'block'},onClick:function onClick(){return onRequest(offset);},children:/*#__PURE__*/_jsx(\"div\",{className:\"inner\",children:\"load more\"})})]});};export default CharList;","map":{"version":3,"names":["useState","useRef","useEffect","useMarvelService","Spinner","ErrorMessage","CharList","props","chars","setCharlist","newItemLoading","setNewItemLoading","offset","setOffset","charEnded","setCharEnded","loading","error","getAllCharacters","onRequest","initial","then","createList","newCharList","ended","length","itemRefs","focusOnItem","id","current","forEach","item","classList","remove","add","focus","elements","map","i","name","thumbnail","el","onCharSelected","e","key","errorMessage","spinner"],"sources":["/Users/alinasvyrydova/Downloads/Development/Course1/Files/marvel-hooks/marvel-hooks/src/components/charList/CharList.js"],"sourcesContent":["import {useState, useRef, useEffect} from 'react';\nimport {PropTypes} from 'prop-types';\nimport useMarvelService from '../../services/MarvelService'\nimport Spinner from '../spinner/Spinner'\nimport ErrorMessage from '../errorMessage/ErrorMessage'\nimport './charList.scss';\n\n\n\n\nconst CharList = (props) => {\n\n    const [chars, setCharlist] = useState([]); \n    const [newItemLoading, setNewItemLoading] = useState(false);\n    const [offset, setOffset] = useState(210);\n    const [charEnded, setCharEnded] = useState(false);\n\n    // focusRef = React.createRef();\n    const {loading, error, getAllCharacters} = useMarvelService();\n   \n    // const marvelService = useMarvelService();\n\n    useEffect (() => {\n        onRequest(offset, true);\n    }, [])\n     \n\n    const onRequest = (offset, initial) => {\n        initial ? setNewItemLoading(false) : setNewItemLoading(true);\n        getAllCharacters(offset)\n        .then(createList) \n    } \n \n \n    const createList = (newCharList) => { \n        let ended = false; \n        if (newCharList.length < 9){\n            ended = true;\n        }\n \n        setCharlist(chars => [...chars, ...newCharList]);\n        setNewItemLoading(newItemLoading => false);\n        setOffset(offset => offset + 9);\n        setCharEnded(charEnded => ended);\n\n    } \n    const itemRefs = useRef([]);\n    \n    const focusOnItem = (id) => {\n \n        itemRefs.current.forEach(item => item.classList.remove('char__item_selected'));\n        itemRefs.current[id].classList.add('char__item_selected');\n        itemRefs.current[id].focus();\n    }\n \n        const elements = chars.map ((item, i) => {\n        const {name, thumbnail, id} = item; \n            return ( \n                 <li className=\"char__item\"\n                 key={id}\n                 ref={el => itemRefs.current[i] = el}\n                 tabIndex={0}\n                 onClick={() => {\n                    props.onCharSelected(id);\n                    focusOnItem(i)\n                }}\n                 onKeyPress={(e) => {\n                     if (e.key === ' ' || e.key === \"Enter\") {\n                         props.onCharSelected(id);\n                         focusOnItem(i);\n                     }\n                 }}> \n                        <img src={thumbnail} alt={name}/>\n                        <div className=\"char__name\">{name}</div>\n                    </li> \n            )\n        });\n\n        const errorMessage = error ? <ErrorMessage/> : null;\n        const spinner = loading && !newItemLoading ? <Spinner/> : null;\n\n        return (\n            <div className=\"char__list\">\n                <ul className=\"char__grid\">\n                {errorMessage}\n                {spinner}\n                {elements}\n                </ul>\n                <button className=\"button button__main button__long\"\n                disabled={newItemLoading}\n                style={{'display': charEnded ? 'none' : 'block'}}\n                onClick={() => onRequest(offset)}>\n                    <div className=\"inner\">load more</div>\n                </button>\n            </div>\n        ) \n}\n\nCharList.propTypes = { \n    onCharSelected: PropTypes.func.isRequired\n}\n\nexport default CharList;"],"mappings":"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"},"metadata":{},"sourceType":"module"}